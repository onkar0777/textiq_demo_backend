(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},164:function(e,t,n){},165:function(e,t,n){},166:function(e,t,n){},169:function(e,t,n){},170:function(e,t,n){},172:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),c=n(9),a=n.n(c),l=(n(100),n(28)),r=n(23),s=n(13),u=(n(101),n(102),n(92));n(164);var d=function(e){return o.a.createElement("div",{className:"list"},o.a.createElement(u.a,{width:e.rowWidth,height:e.listHeight,rowHeight:e.rowHeight,rowRenderer:function(t){var n=t.index,i=t.key,c=t.style;return o.a.createElement("div",{onClick:e.onListItemClick?function(){return e.onListItemClick(e.list[n],n)}:void 0,key:i,style:c,className:n===e.selectedIndex?"".concat(e.selectedClass," ListItems"):"ListItems"},n+1,".\xa0",e.list[n][e.value])},rowCount:e.list.length}))};var f=function(e){return o.a.createElement("div",{className:"ListContainer"},o.a.createElement(d,{listHeight:700,rowHeight:50,rowWidth:250,onListItemClick:e.onListItemClick,list:e.docs,value:"name",selectedIndex:e.selectedIndex,selectedClass:"SelectedListItem"}))},h=n(174),m=(n(165),n(93));n(166);var g=function(e){var t=e.background,n=e.color,i=e.children,c=e.style,a=e.onClick,r={backgroundColor:t,color:n};return o.a.createElement("button",{onClick:a,style:Object(l.a)({},r,c),className:"Button"},i)};var E=function(e){var t=e.document,n=e.entity,c=e.deleteEntity,a=e.saveRelatedEntities,l=e.removeSelectedEntity,r=Object(i.useState)([]),u=Object(s.a)(r,2),d=u[0],f=u[1],h=Object(i.useState)([]),E=Object(s.a)(h,2),v=E[0],y=E[1];return Object(i.useEffect)(function(){var e=t.entities.filter(function(e){return e._id!==n._id});e=e.filter(function(e){return n.linked_to.every(function(t){return t._id!==e._id})}),y(e),f([])},[n,t]),o.a.createElement("div",{className:"EntityPanel"},o.a.createElement("h4",{className:"EntityLabels"},"Selected Named Entity",o.a.createElement("span",{onClick:l,style:{float:"right",cursor:"pointer"}},"x")),o.a.createElement("h4",{className:"SelctedEntityName"},n.val),o.a.createElement("h4",{className:"EntityLabels"},"Related Entities:"),o.a.createElement("ol",{className:"RelatedEntityList"},n.linked_to&&n.linked_to.length?n.linked_to.map(function(e){return o.a.createElement("li",{key:e._id},e.val)}):"NA"),o.a.createElement(m.a,{value:d,onChange:function(e){return f(e)},options:v,isMulti:!0,isSearchable:!0,closeMenuOnSelect:!1,getOptionLabel:function(e){return e.val},getOptionValue:function(e){return e._id},hideSelectedOptions:!0,placeholder:"Select Related Entity"}),o.a.createElement(g,{background:"darkgreen",color:"white",onClick:function(){return a(d)}},"Save Related Entities"),o.a.createElement(g,{background:"darkred",color:"white",onClick:c},"Delete Entity"))},v=n(88),y=n.n(v),p=n(89),b=n.n(p);n(169);var k=function(e){var t=e.document,n=e.selectedEntity,c=e.onHighlightClick,a=e.addSelectedTextAsEntity,l=Object(i.useState)(!1),r=Object(s.a)(l,2),u=r[0],d=r[1],f=Object(i.useState)(""),h=Object(s.a)(f,2),m=h[0],E=h[1],v=function(){var e=window.getSelection().toString();if(e.length&&(!n||n.val!==e))return d(!0),void E(e);E(""),d(!1)};return Object(i.useEffect)(function(){d(!1)},[t]),o.a.createElement(b.a,{isOpen:u,position:"top",content:o.a.createElement(g,{onClick:function(){return a(m)},background:"lightgreen"},"Add as Named Entity")},o.a.createElement(y.a,{className:"HighlightedEmail",highlightClassName:"HighlightClassName",caseSensitive:!0,searchWords:t.searchWords,autoEscape:!0,textToHighlight:t.text,highlightTag:function(e){var t=e.children;return o.a.createElement("mark",{className:n&&n.val===t?"HighlightClassName SelectedHighlight":"HighlightClassName",onClick:function(){return c(t)}},t)},onDoubleClick:v,onMouseUp:v}))},w="http://localhost:3500/api",O=function(){return fetch(w+"/doc").then(function(e){return e.json()}).then(function(e){return e})},j=function(e){return console.log(e),fetch(w+"/doc/file?filename="+e).then(function(e){return e.text()}).then(function(e){return e})},C=function(e){return fetch(w+"/doc/update_related_entities",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()})},S=function(e){return fetch(w+"/doc/entity",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()})},N=function(e){return fetch(w+"/doc/all_entities",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()})},I=function(e){return fetch(w+"/doc/add_entity",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()})};n(170);var _=function(e){var t=e.document,n=e.updateCurrentDocumentOnDeletion,c=e.updateEntityInDoc,a=e.addEntityToDoc,l=e.selectedEntity,r=e.onHighlightClick,s=e.removeSelectedEntity,u=function(){console.log("delete entity- ",l),N({docId:t._id}).then(function(e){n(e)})};return o.a.createElement(i.Fragment,null,o.a.createElement(k,{className:"DocViewer",document:t,selectedEntity:l,onHighlightClick:r,addSelectedTextAsEntity:function(e){console.log(e),I({docId:t._id,selectedText:e}).then(function(e){a(e)})}}),o.a.createElement("div",{className:"entityNodeDiv"},o.a.createElement(h.a,{in:!!l,timeout:2e3,classNames:"entityNode"},o.a.createElement("div",null,!!l&&o.a.createElement(E,{saveRelatedEntities:function(e){console.log("save these- ",l,e),C({docId:t._id,entityId:l._id,relatedEntities:e}).then(function(e){c(e)})},deleteEntity:function(){console.log("delete entity- ",l),S({docId:t._id,entity:l._id}).then(function(e){n(e)})},document:t,entity:l,deleteAllEntities:u,removeSelectedEntity:s}))),o.a.createElement(g,{style:{marginTop:"2rem",width:"100%"},background:"white",color:"maroon",onClick:u},"Delete All Entities")))};var T=function(){var e=Object(i.useState)(null),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(i.useState)(null),u=Object(s.a)(a,2),d=u[0],h=u[1],m=Object(i.useState)([]),g=Object(s.a)(m,2),E=g[0],v=g[1],y=Object(i.useState)(null),p=Object(s.a)(y,2),b=p[0],k=p[1];Object(i.useEffect)(function(){console.log("rendering again"),O().then(function(e){v(e),w(e[0],0)}).catch(function(e){console.log(e)})},[]);var w=function(e,t){h(t),j(e.name).then(function(t){e.text=t,e.searchWords=e.entities.map(function(e){return e.val}),c(e),k(null)})},C=function(e){v([].concat(Object(r.a)(E.slice(0,d)),[e],Object(r.a)(E.slice(d+1))))};return o.a.createElement(i.Fragment,null,o.a.createElement("header",{className:"App-header"},o.a.createElement("h1",null,"Demo for TextIQ ",!!n&&"-".concat(n.name))),o.a.createElement("div",{className:"App"},E.length?o.a.createElement(f,{selectedIndex:d,onListItemClick:w,docs:E}):o.a.createElement("span",null,"Loading..."),!!n&&o.a.createElement(_,{updateCurrentDocumentOnDeletion:function(e){var t=Object(l.a)({},n,{entities:e.entities,searchWords:e.entities.map(function(e){return e.val})});c(t),k(null),C(t)},updateEntityInDoc:function(e){var t=n.entities.findIndex(function(t){return t._id===e._id});if(console.log(t,n,n.entities),-1!==t){var i=Object(l.a)({},n,{entities:[].concat(Object(r.a)(n.entities.slice(0,t)),[e],Object(r.a)(n.entities.slice(t)))});c(i),k(e),C(i)}console.log(t,n,n.entities)},addEntityToDoc:function(e){var t=Object(l.a)({},n,{entities:[].concat(Object(r.a)(n.entities),[e]),searchWords:[].concat(Object(r.a)(n.searchWords),[e.val])});c(t),C(t)},document:n,onHighlightClick:function(e){var t=n.entities.filter(function(t){return t.val===e})[0];console.log(e,t,n.entities),k(t)},selectedEntity:b,removeSelectedEntity:function(){return k(null)}})))},L=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function x(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}a.a.render(o.a.createElement(T,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");L?(function(e,t){fetch(e).then(function(n){var i=n.headers.get("content-type");404===n.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):x(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):x(t,e)})}}()},95:function(e,t,n){e.exports=n(172)}},[[95,1,2]]]);
//# sourceMappingURL=main.a00981e5.chunk.js.map